# 1 Массивы и матрицы Numpy

## 1.1 Упражнения
Создать массивы из списков list

а) массив из 100 чётных чисел, начиная от 2

б) вывести на экран 10 последних элементов этого массива

в) послучить массив этих чисел (массива а) в квадрате

г) получить массив чисел из исходного (а), которые делятся на 3

## 1.2 Чек из супермаркета

Дан чек из супермаркета:

Наименование                         | Кол-во |  Цена  | Цена со скидкой
-------------------------------------|-------:|-------:|----------------:
HORTEX ФАСОЛЬ СТРУЧК. Б/ЗАМ          |      1 | 124.90 | 124.90
ЯБЛОКИ КРИПС ПИНК ОТБОРНЫЕ           |  0.466 | 129.90 | 129.90
ДОБ.НЕК.БОД.ЦИТ.АП/ГР/МАН/ЛИ         |      2 | 189.90 | 109.90
СВЯТ.ИСТ.ВОДА ПРИР.ПИТ.НЕГАЗ. ПЭТ 5Л |      1 | 104.90 | 104.90
СПК СВИНИНА С ГРИБАМИ ЗАП. 1К        |  0.178 | 699.00 | 699.00
МЯГК ВАФ С ВАР СГ ЯШ                 |      2 |  37.60 |  37.60
КАРТОФЕЛЬ БЕЛЫЙ РАНН                 |  0.570 |  44.90 |  44.90
ЧУДО МОЛ.ВАН.СТЕР.ФР.2% 200Г         |      5 |  44.90 |  44.90
ПАКЕТ МАЙКА                          |      1 |   6.90 |   6.90
GOUR.КОРМ MON PETIT.КОШ.КУР.         |     10 |  23.90 |  17.90
Ф-Н.ПЮРЕ И/ЯБ/АБР СО СЛ/САХ          |      6 |  57.90 |  34.90
MATTI МЮСЛИ ОРЕХ/ЯБЛОКО 250Г         |      1 | 129.90 |  69.90
ХЛ.ДОМ КЕКС ЯГ. ЛУК.НАЧ.Ч.СМ         |      1 |  89.90 |  59.90
GREENF.ЧАЙ GOLD.CEYL.ЧЕР.            |      1 | 119.90 |  69.90
КУРИНОЕ ФИЛЕ ПЕТЕЛ.НА ПОДЛ           |  0.758 | 355.01 | 279.89

Он же дан в виде списка наименований и нескольких массивов:

``` python
names = ['HORTEX Фасоль стручк. б/зам', 'Яблоки КРИПС ПИНК отборные', 'ДОБ.НЕК.БОД.ЦИТ.ап/гр/ман/ли', 'СВЯТ.ИСТ.Вода прир.пит.негаз. ПЭТ 5л', 'СПк Свинина с грибами зап. 1к', 'МЯГК ВАФ С ВАР СГ ЯШ', 'КАРТОФЕЛЬ БЕЛЫЙ РАНН', 'ЧУДО Мол.ВАН.стер.фр.2% 200г', 'Пакет майка', 'GOUR.Корм MON PETIT.кош.кур.', 'Ф-Н.Пюре и/яб/абр со сл/сах', 'MATTI Мюсли ОРЕХ/ЯБЛОКО 250г', 'ХЛ.ДОМ Кекс Яг. Лук.нач.ч.см', 'GREENF.Чай GOLD.CEYL.чер.', 'Куриное Филе ПЕТЕЛ.на подл'],
volumes = np.array([1, 0.466, 2, 1, 0.178, 2, 0.57, 5, 1, 10, 6, 1, 1, 1, 0.758])
price = np.array([124.9, 129.9, 189.9, 104.9, 699.0, 37.6, 44.9, 44.9, 6.9, 23.9, 57.9, 129.9, 89.9, 119.9, 355.01])
price_with_discount = np.array([124.9, 129.9, 109.9, 104.9, 699.0, 37.6, 44.9, 44.9, 6.9, 17.9, 34.9, 69.9, 59.9, 69.9, 279.89])
```

а) Посчитать стоимость чека. Это цена со скидкой каждого товара, умноженная на количество. Постарайтесь обойтись без циклов.

<details><summary>Как посчитать сумму чисел в массиве?</summary>
Сумму можно посчитать встроенной функцией <tt><a href="https://docs.python.org/3/library/functions.html#sum" target="_blank">sum()</a></tt>, которая складывает разные типы данных, в том числе и массивы. Но лучше воспользоваться одноимённым методом <tt><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html" target="_blank">название_массива.sum()</a></tt>, он делает то же самое, но быстрее.
</details>

<details><summary>Ответ для проверки</summary>
1767.01, если округлить до копеек
</details>

б) Посчитать, сколько рублей мы сэкономили за счёт скидок. Цена минус цена со скидкой и умножить на количество.

<details><summary>Ответ для проверки</summary>
554.94, если округлить до копеек
</details>

в) Найдите товар с самой большой скидкой в *процентах*. Выведите на экран наименование товара размер его скидки в рублях и процентах.

<details><summary>Как найти самое большое число в массиве?</summary>
Самое большое значение в массиве можно найти методом <tt><a href="https://numpy.org/doc/stable/reference/generated/numpy.sort.html" target="_blank">название_массива.max()</a></tt>. А номер (индекс) самого большого элемента можно найти методом <tt><a href="https://numpy.org/doc/stable/reference/generated/numpy.argmax.html" target="_blank">название_массива.argmax()</a></tt>. Полученный индекс в этой задаче можно применить к соседнему массиву или списку.
</details>

г) Выведите три самых дорогих позиций в чеке (с учётом скидки и объёма).

<details><summary>Как это сделать?</summary>
Отсортировать массив можно методом <tt><a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" target="_blank">название_массива.sort()</a></tt>. А получить номера (индексы) элементов в порядке возрастания этих значений - методом <tt><a href="https://numpy.org/doc/stable/reference/generated/numpy.sort.html" target="_blank">название_массива.argsort()</a></tt>. Из полученного массива индексов можно сделать срез и применить его ко всем соседним массивам (но не к спискам).
</details>

## 1.3 Страны 
Countries.csv

а) считать в массивы годы и населения

б) пересчитать населения в миллионы человек (в исходных данных - просто в людях)
новый массив - ```population_millions (float64)```

в) превратить массив населений (миллионов или человек) и превратить в массив 142x12 (или 12x142)

```python
a.reshape(-1, 12)
a.reshape(12, -1)
```

г) Из получившегося массива населений получить населения Алжира (третий в таблице) за все годы (массив из 12 элементов)

д) Населения всех стран в 2002 году (предпоследний год) - массив из 142 элементов

е) Население мира в 2002 (одно число) - np.sum()

ж*) прирост населений Алжира - 11 чисел


## 1.4 Автомобили

Renault.csv
а) Разобрать csv

``` python
data = csv.reader(f, delimiter = ';')
```

б) Собрать цены, пробеги и названия моделей в массивы - колонка цена, массив целых чисел
нужно удалисть пробелы и символ рубля прежде, чем превратить в число

``` python
s.replace('₽', '')
# ...
```

в) Найти самую большую и самую маленькую цену всех рено
(2 числа, вывести на экран)

```
a.max()
a.min()
```

г) Средний пробег, но  только такой марки: Renault Sandero I Stepway

```
np.mean()
```

д) узнать пробег и марку самой дешёвой машины

 * ```a.argmax()``` - индекс элемента с максимальным значением

 * ```a.argmin()``` - аналогично

## 1.5 Центробанк
 
ЦБ РФ предоставляет данные о курсах валют в виде:

* курсов всех валют в указанный день

* курсов одной валюты в указанном диапазоне дат

Значения можно получить и разобрать самостоятельно с помощью встроенной библииотеки xml ([xml.etree.ElementTree](https://docs.python.org/3/library/xml.etree.elementtree.html)), либо воспользоваться файлом cbr.py (в папке с материалами к курсу). В обоих случаях нужно установить модуль [requests](https://docs.python-requests.org/en/latest/):

```
py -3 -m pip install requests
```

а) получить курсы доллара с 1 июля по сегодняшнее число включительно. Если используете готовый модуль, то загрузка быдет выглядеть так:

``` python
d, p = get_prices('01.07.2021', '19.09.2021', 'USD')
```

получите 2 массива - даты и цены в рублях

б) узнать средний курс

в) узнать, когда курс был дороже всего за период (```argmax```) и сколько он стоил в этот день

г) сохранить полученные массивы в файл с помощью функции ```save()/savez()/savez_compressed()```

д) добавить виджеты для выбора валюты (Dropdown, можно запросить у ЦБ список кодов валют и разобрать) и диапазона дат (```DatePicker```)

## 1.6 Метеостанции
ghcnd-stations.txt

а) Разобрать файл, достать колонки с координатами (2,3,4 колонки) - в виде матрицы float 3 колонки на много строк
и колонку с названиями нас. пунктов - str

2 массива:

``` python
coords = np.empty((n, 3), np.float32) # координаты размером 113000 х 3 float32
coords[:, -1] - массив высот
names = np.empty(n, (str, ...))  # названия - строки какой-то длины
```

Совет: лучше читать по одной строке, т.к. строк много:

``` python
readline()

for line in f:
	# разбор каждой строки
```

б) преобразовать широту и долготу в радианы (без цикла), поможет функция:

```
np.radians()
```

в) найти самую высокую и самую низкую станции и их координаты и названия

есть подвох: есть станции с высотой -999.9, но на самом деле это означает "неизвестно"

г) к пункту в добавить print ссылки вида:

https://maps.google.com/maps?ll=55.755833,37.617222

д) написать ф-ию, которая принимает два кортежа - диапазон широт и диапазон долгот
и печает print'ом самую высокую и низкую точку из этого сектора

## 1.7 Погодные данные

Воспользуемся одним из серверов погодных данных - meteostat.net. С него можно загрузить исторические данные (за прошедшие дни) за выбранный период дат с выбранной метеостанции. Особенности сервиса:

* Это коммерческий сервис, поэтому требуется ключ API. Для этого нужно зарегистрироваться, нам подойдёт бесплатный план.

* Ключ API передаётся не в составе URL запроса, а в заголовке. К счастью, с бсблиотекой ```requests``` это сделать легко:

``` python
resp = requests.get(
	meteo_url,
	params=meteo_params,
	headers={'X-RapidAPI-Key': meteo_api_key}
	)
```

* Ответ приходит в формате JSON. Его очень просто превратить в обычный словарь с помощью [одноимённой стандартной библиотеки](https://docs.python.org/3/library/json.html):

``` python
import json
data = json.loads(json_text)  # передаём строку str с текстом ответа
```

ДАнные можно получить с помощью файла meteostat.py из материалов курса, либо сделать разбор самостоятельно.

а) Получить данные с метеостата за последние 365 дней, или какой-то другой период. На выходе собрать два массива:

 * массив дат в виде строк
 * иматрицу температур - 3 колонки min, max, avg в виде float

б) найти дисперсию средних температур, желательно без циклов

![\Large\sigma=\frac{(x_1-s)^2+(x_2-s)^2+\ldots+(x_n-s)^2}{n-1}](https://latex.codecogs.com/svg.latex?\Large\sigma=\frac{(x_1-s)^2+(x_2-s)^2+\ldots+(x_n-s)^2}{n-1})

(где s - это среднее арифметическое)

в) найти максимальную разницу между минимальной и максимальной температурой за сутки, узнать в какой день это было

г) (по желанию) добавить виджет в сыбором диапазона дат и метеостанции


# Задачи на базовые операции в Pandas

## Атлеты

atlete_events.csv

а) найти самого старого и самого молодого атлетов за всё время, вывести на экран строчки с ними

б) Средний рост спортсменов в 2008 году

в) Средний вес спортсменов в дисциплине Weightlifting
